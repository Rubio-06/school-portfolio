---
export type LinkVariant = "primary" | "secondary" | "ghost" | "icon";
export type LinkSize = "sm" | "md" | "lg";

interface LinkProps {
  href: string;
  target?: "_blank" | "_self" | "_parent" | "_top";
  variant?: LinkVariant;
  size?: LinkSize;
  download?: boolean;
  class?: string;
}

const {
  href,
  target = "_self",
  variant = "primary",
  size = "md",
  download = false,
  class: className = "",
} = Astro.props;

const variantClasses: Record<LinkVariant, string> = {
  primary:
    "group relative inline-flex items-center justify-center gap-2 overflow-hidden rounded-full bg-gradient-to-r from-blue-500 to-purple-500 font-semibold text-white shadow-lg shadow-blue-500/30 transition-all duration-300 hover:shadow-xl hover:shadow-blue-500/50 hover:scale-105",
  secondary:
    "group inline-flex items-center justify-center gap-2 rounded-full border-2 border-white/20 bg-white/5 font-semibold text-white backdrop-blur-sm transition-all duration-300 hover:border-white/40 hover:bg-white/10 hover:scale-105",
  ghost:
    "group inline-flex items-center justify-center gap-2 font-semibold text-gray-400 transition-all duration-300 hover:text-white",
  icon: "group inline-flex items-center justify-center text-gray-400 transition-all duration-300 hover:text-white hover:scale-110",
};

const sizeClasses: Record<LinkSize, string> = {
  sm: "px-6 py-2 text-sm",
  md: "px-8 py-4 text-base",
  lg: "px-10 py-5 text-lg",
};

const linkClasses =
  variant === "icon"
    ? `${variantClasses[variant]} ${className}`
    : `${variantClasses[variant]} ${sizeClasses[size]} ${className}`;
---

<a href={href} target={target} download={download} data-link class={linkClasses}>
  {
    variant === "primary" && (
      <>
        <span class="relative z-10 flex items-center gap-2">
          <slot />
        </span>
        <div class="absolute inset-0 -z-0 bg-gradient-to-r from-blue-600 to-purple-600 opacity-0 transition-opacity duration-300 group-hover:opacity-100" />
      </>
    )
  }
  {variant !== "primary" && <slot />}
</a>

<script>
  import { gsap } from "gsap";

  document.addEventListener("astro:page-load", () => {
    const links = document.querySelectorAll("[data-link]");

    links.forEach((link) => {
      // Ne pas animer les liens icon ou ghost
      const hasIconClass =
        link.classList.contains("group") &&
        (link.textContent?.trim() === "" || link.querySelector("svg"));

      if (hasIconClass) return;

      link.addEventListener("mouseenter", (e) => {
        gsap.to(e.currentTarget, {
          scale: 1.05,
          duration: 0.3,
          ease: "power2.out",
        });
      });

      link.addEventListener("mouseleave", (e) => {
        gsap.to(e.currentTarget, {
          scale: 1,
          duration: 0.3,
          ease: "power2.out",
        });
      });
    });
  });
</script>
