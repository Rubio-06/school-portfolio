---
import type { CollectionEntry } from "astro:content";

interface Props {
  post: CollectionEntry<"blog">;
}

const { post } = Astro.props;
const { title, description, date, category, tags } = post.data;

// Calculer le temps de lecture (approximation)
const readingTime = Math.ceil(post.body.split(/\s+/).length / 200);

// Formater la date
const formattedDate = new Intl.DateTimeFormat("fr-FR", {
  year: "numeric",
  month: "long",
  day: "numeric",
}).format(date);

// Couleurs par catégorie
const categoryColors = {
  framework: {
    border: "border-blue-500/20",
    bg: "from-blue-500/10 to-blue-600/5",
    text: "text-blue-400",
    hover: "hover:border-blue-500/40",
  },
  performance: {
    border: "border-green-500/20",
    bg: "from-green-500/10 to-green-600/5",
    text: "text-green-400",
    hover: "hover:border-green-500/40",
  },
  architecture: {
    border: "border-purple-500/20",
    bg: "from-purple-500/10 to-purple-600/5",
    text: "text-purple-400",
    hover: "hover:border-purple-500/40",
  },
  tooling: {
    border: "border-orange-500/20",
    bg: "from-orange-500/10 to-orange-600/5",
    text: "text-orange-400",
    hover: "hover:border-orange-500/40",
  },
  "best-practices": {
    border: "border-pink-500/20",
    bg: "from-pink-500/10 to-pink-600/5",
    text: "text-pink-400",
    hover: "hover:border-pink-500/40",
  },
};

const colors = categoryColors[category];

const categoryLabels = {
  framework: "Framework",
  performance: "Performance",
  architecture: "Architecture",
  tooling: "Outillage",
  "best-practices": "Bonnes Pratiques",
};
---

<article
  class="blog-article group rounded-2xl border border-white/10 bg-white/5 p-8 backdrop-blur-sm transition-all duration-300 hover:border-white/20"
  data-category={category}
  data-tags={tags.join(",")}
>
  <a href={`/blog/${post.slug}`} class="block">
    <!-- En-tête -->
    <div class="mb-4 flex flex-wrap items-center gap-3 text-sm text-gray-400">
      <time datetime={date.toISOString()}>{formattedDate}</time>
      <span>·</span>
      <span class="flex items-center gap-1">
        <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        {readingTime} min
      </span>
      <span>·</span>
      <span class={colors.text}>{categoryLabels[category]}</span>
    </div>

    <!-- Titre -->
    <h2
      class="mb-3 text-2xl font-bold text-white transition-colors duration-300 group-hover:bg-gradient-to-r group-hover:from-blue-400 group-hover:to-purple-500 group-hover:bg-clip-text group-hover:text-transparent"
    >
      {title}
    </h2>

    <!-- Description -->
    <p class="mb-6 leading-relaxed text-gray-400">
      {description}
    </p>

    <!-- Tags -->
    <div class="flex flex-wrap gap-2">
      {
        tags.map((tag) => (
          <span
            class={`rounded-full border bg-gradient-to-r px-3 py-1.5 text-xs font-medium text-white backdrop-blur-md transition-all duration-300 ${colors.border} ${colors.bg}`}
          >
            #{tag}
          </span>
        ))
      }
    </div>
  </a>
</article>
